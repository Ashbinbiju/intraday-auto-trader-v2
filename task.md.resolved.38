# Task List

- [x] **Core Bot & Initial UI (v1.0)** <!-- id: 100 -->
    - [x] Scraper, SmartAPI, Indicators, Logic, Basic API, Basic Dashboard.

- [x] **Backend Upgrade (v2.0)** <!-- id: 29 -->
    - [x] **Settings API**: Endpoint to GET/POST config (Risk, Limits, Timings) <!-- id: 30 -->
    - [x] **Trade Management API**: Endpoints to Close Position, Kill Switch <!-- id: 31 -->
    - [x] **Enhanced Logging**: Structured logs (Scan, Signal, Order, Error) exposed via API <!-- id: 32 -->
    - [x] **Metrics Engine**: Calculate P&L, Win Rate (Today) <!-- id: 33 -->
    - [x] **Holiday/Weekend Check**: Prevent bot from running on non-trading days <!-- id: 45 -->

- [x] **Robustness & Reliability** <!-- id: 50 -->
    - [x] **Order Reconciliation**: Sync `BOT_STATE` with Broker (`/maxOrders`, `/position`) to fix ghost trades <!-- id: 51 -->
    - [x] **Intent Logging**: Log "WHY" a trade was skipped (e.g., "Price below VWAP") <!-- id: 52 -->
    - [x] **Rate Limiting**: Throttled Position Manager (5 req/sec) and configured Retry Logic to prevent API bans.
    - [x] **Real-Time Order Updates**: Integrated "Smart Order Update" WebSocket to bypass polling latency.
    - [x] **Margin Calculator**: Added `/tool/margin` endpoint to check required margin for positions.
    - [x] **Postback Webhook**: Added `/webhook/angel-one` to support HTTPS postbacks from Angel One.
    - [x] **Portfolio APIs**: Added endpoints for Holdings (`/portfolio/holdings`) and Conversion (`/portfolio/convert`).
    - [x] **Brokerage Calculator**: Added `/tool/brokerage` endpoint to estimate charges before trading.
    - [x] **Order APIs**: Added endpoints for Place, Modify, Cancel, Books, and LTP (`/order/*`).
    - [x] **Error Handling**: Implemented Error Map (`AG8001` -> "Invalid Token") for clear debugging logs.
    - [x] **API Audit**: Verified Response Structure and patched [status](file:///C:/Users/Ashbin/.gemini/antigravity/brain/2df2ed12-f98d-4c89-bf98-dea5fc2acbc3/smart_api_helper.py#41-50) check to handle boolean/string inconsistency.
    - [x] **Dashboard Sync**: Fixed issue where "Max Trades/Day" setting was not reflected in the Dashboard UI.
    - [x] **Limit Display Fix**: Initialized `BOT_STATE['limits']` to prevent "Limit: -/Day" on startup.
    - [x] **Config Sync**: Ensured [main.py](file:///C:/Users/Ashbin/.gemini/antigravity/brain/2df2ed12-f98d-4c89-bf98-dea5fc2acbc3/main.py) initialization uses saved config values instead of hardcoded defaults.
    - [x] **Instant Sync**: Patched `POST /settings` to broadcast changes immediately via WebSocket, bypassing bot loop delay.
    - [x] **UI Polish**: Renamed "Live Scrape" badge to "Live Scan" on Dashboard for clarity.

- [x] **Frontend Upgrade (v2.0)** <!-- id: 34 -->
    - [x] **Layout**: Implement Sidebar Navigation (Dashboard, Signals, Trades, Journal, Settings, Logs) <!-- id: 35 -->
    - [x] **Dashboard Home**: P&L Cards, Win Rate, Sector Heatmap <!-- id: 36 -->
    - [x] **Live Signals**: Detailed Table (Reason: VWAP/EMA, Status: Entered/Skipped) <!-- id: 37 -->
    - [x] **Active Trades**: Position Manager Cards with Progress Bar & Exit Button <!-- id: 38 -->
    - [x] **Settings Page**: Form to control Bot Config (SL, TP, Limits) <!-- id: 39 -->
    - [x] **Logs Page**: Tabbed Log Viewer (Scan, Signal, Error) <!-- id: 40 -->

    - [x] **Active Trades**: Added "Time Active" counter and "Setup Grade" badge <!-- id: 53 -->
    - [x] **Trade Journal**: Added "Auto Grade" (A+/A/B) and "Exit Reason" columns <!-- id: 54 -->

- [x] **Final Verification** <!-- id: 41 -->
- [x] **Final Verification** <!-- id: 41 -->
    - [x] **WebSocket Migration**: Replaced polling with instant WS updates <!-- id: 55 -->
    - [x] **Mobile Optimization**: Fixed layout overflow, added Bottom Navigation Bar <!-- id: 56 -->
    - [x] **Fix Control Panel Latency**: Async Broadcast for instant Kill Switch/Resume/Exit updates.
    - [x] Verify End-to-End Flow (Config -> Bot -> Trade -> Exit) <!-- id: 42 -->
